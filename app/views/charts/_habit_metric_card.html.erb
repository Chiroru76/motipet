<%
# 習慣メトリックカードのパーシャル
# @param tid [Integer] タスクID
# @param meta [Hash] タスクメタデータ { title:, unit: }
# @param series [Hash] 日別データ { date => value }
# @param total [Numeric] 合計値
%>
<div class="group/card relative">
  <div class="absolute -inset-0.5 bg-gradient-to-br from-yellow-200/60 to-yellow-300/60 rounded-2xl blur opacity-0 group-hover/card:opacity-20 transition duration-500"></div>
  <div class="relative bg-white rounded-2xl border border-yellow-100/50 overflow-hidden shadow-md hover:shadow-lg transition-all duration-300">

    <!-- Card Header with Stat -->
    <div class="relative bg-gradient-to-br from-yellow-50 to-yellow-100/50 px-5 py-4 border-b border-yellow-100/50">
      <div class="flex items-start justify-between gap-3 mb-3">
        <h3 class="font-black text-gray-900 text-base leading-tight flex-1 line-clamp-2">
          <%= meta[:title] %>
        </h3>
      </div>

      <!-- Large Stat Display -->
      <div class="flex items-end gap-2">
        <div class="relative">
          <div class="absolute inset-0 bg-gradient-to-br from-yellow-300 to-yellow-400 blur-sm opacity-15"></div>
          <div class="relative text-5xl font-black bg-gradient-to-br from-yellow-600 to-yellow-700 bg-clip-text text-transparent tabular-nums">
            <%= total %>
          </div>
        </div>
        <div class="text-xs font-bold text-gray-500 mb-2">
          <%= t("enums.task.target_unit.#{meta[:unit]}", default: meta[:unit]) %>
        </div>
      </div>
    </div>

    <!-- Mini Chart -->
    <div class="p-4 bg-white">
      <%= column_chart series,
            xtitle: "",
            ytitle: "",
            points: false,
            curve: true,
            colors: ["#eab308"],
            library: habit_metric_chart_options %>
    </div>
  </div>
</div>
